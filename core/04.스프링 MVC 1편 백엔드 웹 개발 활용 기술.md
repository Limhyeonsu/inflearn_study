# 04. 스프링 MVC 1편 - 백엔드 웹 개발 활용 기술
## 4-1. 웹 애플리케이션 이해
### 웹 서버, 웹 애플리케이션 서버
웹은 HTTP 기반이다. HTTP 메시지에 모든 것을 전송한다. HTML, TEXT, 이미지, 음성, 영상, JSON, XML 등등..

웹 서버는 HTTP 기반으로 동작하고, __정적 리소스__ (HTML, CSS, JS, 이미지, 영상)를 제공한다. 예) Nginx, apache

웹 애플리케이션 서버(WAS)는 HTTP 기반으로 동작하고, 웹 서버 기능을 포함하고 있다. 프로그램 코드를 실행해서 애플리케이션 로직을 수행한다. 예) 톰캣, Jetty..

[웹 서버와 웹 애플리케이션 서버의 차이]
* 웹 서버는 정적 리소스, WAS는 애플리케이션 로직
* 자바에서는 서블릿 컨테이너 기능을 제공하면 WAS라고 한다.
* WAS는 애플리케이션 코드를 실행하는데 더 특화되어 있다.

웹 시스템에서는 WAS, DB만으로 시스템을 구성할 수 있다. WAS는 정적 리소스, 애플리케이션 로직 모두 제공한다. WAS가 너무 많은 역할을 담당하고 있어, 서버 과부하 우려가 있다. WAS에서 장애가 발생하면 오류 화면도 노출이 불가능하다. 그래서 `웹 시스템 구성을 WEB, WAS, DB`로 구성하여 정적 리소스는 웹 서버가 동적인 처리가 필요한 것은 WAS에 요청을 위임하여 WAS는 중요한 애플리케이션 로직 처리를 전담한다.

이렇게 나누게 되면 리소스를 효율적으로 관리할 수 있다. 정적 리소스가 많이 사용되면 WEB 서버를 증설하고, 애플리케이션 리소스가 많이 사용되면 WAS를 증설하면 된다. 정적 리소스만 제공하는 웹 서버는 자 죽지 않고 WAS 서버는 잘 죽는다. 그래서 WAS, DB에서 장애가 발생하는 경우 웹 서버가 오류 화면을 제공할 수 있다.

### 서블릿
HTML Form 데이터 전송시 웹 애플리케이션 서버를 직접 구현하는 경우 처리해야 하는 업무가 굉장히 많다.
* 서버 TCP/IP 연결대기, 소켓 연결
* HTTP 요청 메시지 파싱해서 읽기
* POST 방식, URL 인지
* Content-Type 확인
* HTTP 메시지 바디 내용 파싱
* 저장 프로세스 실행
* `비즈니스 로직 실행` > 데이터베이스에 저장 요청
* HTTP 응답 메시지 생성 시작
* TCP/IP에 응답 전달, 소켓 종료

여기서 중요한 것은 비즈니스 로직 실행 부분인데 부수적으로 해야할 일이 너무 많다. 이때 서블릿을 지원하는 WAS를 사용하면 비즈니스 로직을 제외한 처리 부분을 서블릿이 처리해준다.

```
@WebServlet(name="helloServlet", urlPatterns="/hello")
public class HelloServlet extends HttpServlet {
    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) {
        //애플리케이션 로직 실행
    }
}
```
/hello URL이 호출되면 서블릿 코드가 실행되고 HTTP 요청, 응답을 편리하게 사용할 수 있는 HttpServletRequest, HttpServletResponse 객체를 제공해 준다. 이로인해 개발자는 HTTP 스펙을 매우 편리하게 사용할 수 있다.

[HTTP 요청 응답 흐름]
* WAS는 Request, Response 객체를 새로 만들어서 서블릿 객체 호출
* 개발자는 Request 객체에서 HTTP 요청 정보를 편리하게 꺼내서 사용
* 개발자는 Response 객체에 HTTP 응답 정보를 편리하게 입력
* WAS는 Response 객체에 담겨있는 내용으로 HTTP 응답 정보를 생성

[서블릿 컨테이너]
* 서블릿을 지원하는 WAS를 서블릿 컨테이너라고 한다.
* 서블릿 컨테이너는 서블릿 객체를 생성, 초기화, 호출, 종료하는 생명주기를 관리한다.
* 서블릿 객체는 싱글톤으로 관리한다. (컨테이너 종료시 함께 종료)
* JSP도 서블릿으로 변환되어서 사용한다.
* 동시 요청을 위한 멀티 쓰레드 처리를 지원한다.
